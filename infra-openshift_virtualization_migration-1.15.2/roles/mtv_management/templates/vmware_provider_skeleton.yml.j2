apiVersion: forklift.konveyor.io/v1beta1
kind: Provider
metadata:
  name: "{{ populated_vmware_target['name'] }}"
  namespace: "{{ mtv_management_provider_namespace }}"
spec:
  secret:
    name: "{{ vmware_provider_secret_name }}"
    namespace: "{{ vmware_provider_secret_namespace }}"
  type: vsphere
  url: "{{ mtv_vmware_url }}"
{% if 'vddk' in populated_vmware_target and populated_vmware_target['vddk'] is not none and 'image' in populated_vmware_target['vddk'] and (populated_vmware_target['vddk']['image'] | default("", true) | length > 0)  %}
  settings:
    vddkInitImage: "{{ populated_vmware_target['vddk']['image'] }}"
{% endif %}
